{"version":3,"sources":["spacebunny.js"],"names":[],"mappings":"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","file":"spacebunny.js","sourcesContent":["/**\n * A module that exports the base SpaceBunny client\n * @module SpaceBunny\n */\n\n// Import some helpers modules\nimport fs from 'fs';\nimport merge from 'merge';\nimport axios from 'axios';\nimport humps from 'humps';\nimport Promise from 'bluebird';\nimport { startsWith, filter } from 'lodash';\n\n// TODO validate enpointConfig object format with Joi\n// import Joi from 'joi';\n\nconst CONFIG = require('../config/constants').CONFIG;\n\n/**\n * @constructor\n * @param {Object} opts - constructor options may contain Device-Key or connection options\n */\nclass SpaceBunny {\n  constructor(opts = {}) {\n    this._connectionParams = merge({}, humps.camelizeKeys(opts));\n    this._endpointConfigs = undefined;\n    this._endpointUrl = this._connectionParams.endpointUrl;\n    this._deviceKey = this._connectionParams.deviceKey;\n    this._channels = this._connectionParams.channels;\n    this._deviceId = this._connectionParams.deviceId;\n    this._client = this._connectionParams.client;\n    this._secret = this._connectionParams.secret;\n    this._host = this._connectionParams.host;\n    this._port = this._connectionParams.port;\n    this._vhost = this._connectionParams.vhost;\n    this._protocol = CONFIG.protocol;\n    this._inboxTopic = this._connectionParams.inputTopic || CONFIG.inboxTopic;\n    this._liveStreamSuffix = CONFIG.liveStreamSuffix;\n    this._tempQueueSuffix = CONFIG.tempQueueSuffix;\n    this._liveStreams = [];\n    this._ssl = this._connectionParams.ssl || false;\n    this._sslOpts = {};\n    if (this._connectionParams.cert) { this._sslOpts.cert = fs.readFileSync(this._connectionParams.cert); }\n    if (this._connectionParams.key) { this._sslOpts.key = fs.readFileSync(this._connectionParams.key); }\n    if (this._connectionParams.passphrase) { this._sslOpts.passphrase = this._connectionParams.passphrase; }\n    if (this._connectionParams.ca) { this._sslOpts.ca = [fs.readFileSync(this._connectionParams.ca)];}\n    if (this._connectionParams.pfx) { this._sslOpts.pfx = fs.readFileSync(this._connectionParams.pfx); }\n    this._sslOpts.secureProtocol = this._connectionParams.secureProtocol || CONFIG.ssl.secureProtocol;\n  }\n\n  // TODO this function should return a Promise!! Need to be async\n  /**\n   * Check if Device-Key or connection parameters have already been passed\n   * If at least Device-Key is passed ask the endpoint for the configurations\n   * else if also connection parameters are not passed raise an exception\n   *\n   * @return an Object containing the connection parameters\n   */\n  getEndpointConfigs() {\n    return new Promise((resolve, reject) => {\n      // Resolve with configs if already retrieved\n      if (this._endpointConfigs !== undefined) {\n        resolve(this._endpointConfigs);\n      }\n      // Contact endpoint to retrieve configs\n      // Switch endpoint if you are using sdk as device or as access key stream\n      let endpoint = '';\n      if ((this._deviceId && this._secret) || this._deviceKey) { // Device credentials\n        endpoint = CONFIG.deviceEndpoint;\n        // uses endpoint passed from user, default endpoint otherwise\n        const hostname = this._generateHostname(endpoint);\n        const uri = `${hostname}${endpoint.api_version}${endpoint.path}`;\n        if (this._deviceKey) { // Get configs from endpoint\n          const options = {\n            url: uri,\n            method: 'get',\n            responseType: 'json',\n            headers: {\n              'Device-Key': this._deviceKey,\n              'Content-Type': 'application/json'\n            }\n          };\n          axios(options).then((response) => {\n            this._endpointConfigs = humps.camelizeKeys(response.data);\n            this._connectionParams = this._endpointConfigs.connection;\n            resolve(this._endpointConfigs);\n          }).catch((err) => {\n            reject(err);\n          });\n        } else if (this._deviceId && this._secret && this._host && this._port && this._vhost) {\n          // Manually provided configs\n          this._connectionParams.protocols = {};\n          if (this._ssl) {\n            this._connectionParams.protocols[this._protocol] = { sslPort: this._port };\n          } else {\n            this._connectionParams.protocols[this._protocol] = { port: this._port };\n          }\n          this._endpointConfigs = {\n            connection: this._connectionParams,\n            channels: []\n          };\n          resolve(this._endpointConfigs);\n        }\n      } else if (this._client && this._secret) { // Access key credentials\n        if (this._host && this._port && this._vhost) {\n          // Manually provided configs\n          this._connectionParams.protocols = {};\n          if (this._ssl) {\n            this._connectionParams.protocols[this._protocol] = { sslPort: this._port };\n          } else {\n            this._connectionParams.protocols[this._protocol] = { port: this._port };\n          }\n          this._endpointConfigs = {\n            connection: this._connectionParams,\n            liveStreams: []\n          };\n          resolve(this._endpointConfigs);\n        } else {\n          // Get configs from endpoint\n          endpoint = CONFIG.accessKeyEndpoint;\n          // uses endpoint passed from user, default endpoint otherwise\n          const hostname = this._generateHostname(endpoint);\n          const uri = `${hostname}${endpoint.api_version}${endpoint.path}`;\n          const options = {\n            url: uri,\n            method: 'get',\n            responseType: 'json',\n            headers: {\n              'Live-Stream-Key-Client': this._client,\n              'Live-Stream-Key-Secret': this._secret,\n              'Content-Type': 'application/json'\n            }\n          };\n          axios(options).then((response) => {\n            this._endpointConfigs = humps.camelizeKeys(response.data);\n            this._connectionParams = this._endpointConfigs.connection;\n            this._liveStreams = this._endpointConfigs.liveStreams || [];\n            resolve(this._endpointConfigs);\n          }).catch((err) => {\n            reject(err);\n          });\n        }\n      } else { // No configs or missing some info\n        reject('Missing Device Key or wrong connection parameters');\n      }\n    });\n  }\n\n  /**\n   * @return all channels configured for the current device\n   */\n  channels() {\n    this.getEndpointConfigs().then((endpointConfigs) => {\n      this._channels = endpointConfigs.channels.map((obj) => {\n        return obj.name;\n      });\n      return this._channels || [];\n    });\n  }\n\n  /**\n   * @return the device ID for the current device\n   */\n  deviceId() {\n    this._deviceId = this._deviceId || this._connectionParams.deviceId;\n    return this._deviceId;\n  }\n\n  /**\n   * Return a Stream ID from a stream name given in input\n   *\n   * @param {String} streamName - stream name\n   * @return the stream ID which corresponds to the input stream name\n   */\n  liveStreamByName(streamName) {\n    const liveStreams = filter(this._liveStreams, (stream) => { return stream.name === streamName; });\n    if (liveStreams.length > 0) {\n      return liveStreams[0].id || streamName;\n    } else {\n      return streamName;\n    }\n  }\n\n  /**\n   * Check if a stream exists\n   *\n   * @param {String} streamName - stream name\n   * @return true if stream exists, false otherwise\n   */\n  liveStreamExists(streamName) {\n    const liveStreams = filter(this._liveStreams, (stream) => { return stream.name === streamName; });\n    return (liveStreams.length > 0);\n  }\n\n  /**\n   * Generate a temporary queue name\n   *\n   * @private\n   * @param {String} prefix - client id or stream name\n   * @param {String} suffix - channel name or defaul live stream suffix\n   * @param {Numeric} currentTime - current timestamp\n   * @return a string that represents the topic name for that channel\n   */\n  tempQueue(prefix, suffix, currentTime) {\n    const timestamp = currentTime || new Date().getTime();\n    return `${timestamp}-${this._connectionParams.client}-` +\n      `${this.exchangeName(prefix, suffix)}.` +\n      `${this._tempQueueSuffix}`;\n  }\n\n  /**\n   * Generate the exchange name for a device's channel\n   *\n   * @private\n   * @param {String} prefix - It could be a device id or a stream name\n   * @param {String} suffix - It could be a channel name or a the default stream suffix (live_stream)\n   * @return a string that represents the complete exchange name\n   */\n  exchangeName(prefix, suffix) {\n    return (prefix && suffix) ? `${this.liveStreamByName(prefix)}.${suffix}` : `${suffix}`;\n  }\n\n  // ------------ PRIVATE METHODS -------------------\n\n  /**\n   * Encapsulates contens for publishing messages.\n   * If the content is a valid JSON the function stringifies the content\n   *\n   * @private\n   * @param {Object} content - content to publish, could be a string or a JSON object\n   * @return the content encapsulated in the proper way\n   */\n  _encapsulateContent(content) {\n    let encapsulatedContent = content;\n    try {\n      encapsulatedContent = JSON.stringify(content);\n    } catch (ex) {\n      encapsulatedContent = content;\n    }\n    return encapsulatedContent;\n  }\n\n  /**\n   * Check if the required parameters are present to open a secure connection\n   *\n   * @private\n   * @return true when a combination of valid parameters is present, false otherwise\n   */\n  _checkSslOptions() {\n    const sslOpts = this._sslOpts;\n    if (sslOpts.ca) {\n      if (sslOpts.cert && sslOpts.key) {\n        return true;\n      } else if (sslOpts.pfx) {\n        return true;\n      } else {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  }\n\n  /**\n   * Generate the complete hostname string for an endpoint\n   *\n   * @private\n   * @return the string representing the endpoint url\n   */\n  _generateHostname(endpoint) {\n    let hostname = `${(this._endpointUrl || endpoint.url)}`;\n    const endpointProtocol = (this._ssl) ? CONFIG.endpoint.secureProtocol : CONFIG.endpoint.protocol;\n    if (!startsWith(hostname, endpointProtocol)) {\n      hostname = `${endpointProtocol}://${hostname}`;\n    }\n    return hostname;\n  }\n\n  /**\n   * Automatically parse message content\n   *\n   * @private\n   * @param {Object/String} message - the received message\n   * @return an object containing the input message with parsed content\n   */\n  _parseContent(message) {\n    let parsedMessage = message;\n    if (Buffer.isBuffer(parsedMessage)) {\n      const content = parsedMessage.toString('utf-8');\n      try {\n        parsedMessage = JSON.parse(content);\n      } catch (ex) {\n        parsedMessage = content;\n      }\n    }\n    return parsedMessage;\n  }\n\n}\n\nexport default SpaceBunny;\n"],"sourceRoot":"/Users/gfoiani/Dev/work/spacebunny/sdk/node/src"}